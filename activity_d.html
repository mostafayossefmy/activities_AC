<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <title>ØªÙƒÙˆÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* âœ… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø®Ø· */
        @font-face {
            font-family: 'NotoSansArabic_Condensed-Bold';
            src: url('fonts/NotoSansArabic_Condensed-Bold.ttf') format('truetype');
        }

        body {
            margin: 0;
            padding: 0;
            background: url('images/back_a_img.png') no-repeat center center;
            background-size: cover;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'NotoSansArabic_Condensed-Bold', sans-serif;
            overflow: hidden;
        }

        .activity-container {
            width: 100%;
            max-width: 1000px;
            height: 80vh;
            max-height: 800px;
            background: #ffffff;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            position: relative;
            display: flex;
            flex-direction: row-reverse;
            align-items: center;
            justify-content: space-between;
        }

        /* ===== Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ===== */
        .sidebar {
            width: 16%;
            background: #f3e8ff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            padding: 15px 10px;
            border-top-right-radius: 15px;
            border-bottom-right-radius: 15px;
            box-sizing: border-box;
            height: 100%;
        }

        .sidebar .row {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* â­ Ø§Ù„ØµÙ 1: Ø§Ù„Ù†Ø¬ÙˆÙ… (Ø§Ù„ÙˆØ³Ø·Ù‰ Ù…Ø±ØªÙØ¹Ø© Ø¬Ù…Ø§Ù„ÙŠØ§Ù‹) */
        .stars {
            direction: rtl;
            /* ğŸ‘ˆ ÙØ±Ø¶ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† */
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 6px;
        }

        .stars img {
            width: 30px;
            height: 30px;
            transition: transform .25s ease, filter .25s ease;
        }

        .stars img:nth-child(2) {
            transform: translateY(-6px);
        }

        /* âœï¸ Ø§Ù„ØµÙ 3: Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ */
        .child-photo img {
            width: 110px;
            height: auto;
            display: block;
            border-radius: 8px;
        }

        .student-name {
            margin: 0;
            padding: 0;
            text-align: center;
        }

        /* âœï¸ Ø§Ù„ØµÙ 3: Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ */
        .student-name p {
            margin: 0;
            font-size: 16px;
            font-weight: bold;
            background: #fff;
            border-radius: 12px;
            padding: 6px 12px;
            display: inline-block;

            /* âœ… Ù…Ù†Ø¹ Ø§Ù„Ø§Ù„ØªÙØ§Ù Ø¹Ù„Ù‰ Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯ */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            /* ÙŠØ¸Ù‡Ø± ... Ø¥Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ù‹Ø§ */
        }

        /* â±ï¸ Ø§Ù„ØµÙ 4: Ø§Ù„Ù…Ø¤Ù‚Øª */
        .timer img {
            width: 80px;
            height: 100px;
            object-fit: contain;
        }

        /* ğŸ ğŸ”„ Ø§Ù„ØµÙ 5: Ø§Ù„ØªØ­ÙƒÙ… (Ù‡ÙˆÙ… Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†ØŒ Ø±ÙŠØ³Øª Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±) */
        .controls {
            display: flex;
            justify-content: center;
            gap: 30px;
            width: 100%;
            box-sizing: border-box;
        }

        .controls .right {
            order: 2;
        }

        /* Ø§Ù„Ù‡ÙˆÙ… ÙŠÙ…ÙŠÙ† */
        .controls .left {
            order: 1;
        }

        /* Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ ÙŠØ³Ø§Ø± */
        .controls img {
            width: 55px;
            height: 55px;
            cursor: pointer;
            transition: transform 0.15s ease;
        }

        .controls img:hover {
            transform: scale(1.08);
        }

        /* ===== Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†Ø´Ø§Ø· ===== */
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            height: 100%;
            position: relative;
        }

        .activity-label {
            position: absolute;
            top: 10px;
            left: -45px;
            width: 180px;
            transform: rotate(-40deg);
        }

        .image-box {
            width: 220px;
            height: 220px;
            background-image: url("images/back_img.png");
            background-size: cover;
            background-position: center;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-box img {
            max-width: 180px;
            max-height: 180px;
        }

        .word-drop-zone {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 70px;
            width: 90%;
            max-width: 400px;
            background: #ffffcc;
            border: 10px solid #ff9966;
            border-radius: 10px;
            padding: 10px;
            font-size: 36px;
            font-weight: bold;
            color: #2a06f5;
            direction: rtl;
            font-family: 'NotoSansArabic_Condensed-Bold', sans-serif;
            transition: box-shadow 0.5s ease-in-out;
        }

        .letters-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            direction: rtl;
        }

        .letter {
            width: 55px;
            height: 55px;
            background-image: url("images/back_letter.png");
            background-size: cover;
            background-position: center;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            font-family: 'NotoSansArabic_Condensed-Bold', sans-serif;
        }

        .letter:hover {
            transform: scale(1.1);
        }

        .glowing-box {
            animation: correctGlow 1.5s ease-in-out 2;
        }

        @keyframes correctGlow {
            0% {
                box-shadow: 0 0 0 #4CAF50;
            }

            50% {
                box-shadow: 0 0 25px 8px #4CAF50;
            }

            100% {
                box-shadow: 0 0 0 #4CAF50;
            }
        }

        .star {
            position: absolute;
            width: 20px;
            height: 20px;
            background-image: url('images/star.png');
            background-size: contain;
            background-repeat: no-repeat;
            opacity: 0;
            animation: star-fly 4s forwards;
            z-index: 10;
        }

        @keyframes star-fly {
            0% {
                transform: translate(0, 0) scale(0.5);
                opacity: 1;
            }

            100% {
                transform: translate(var(--end-x), var(--end-y)) scale(0.1);
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div class="activity-container">
        <!-- âœ… Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
        <div class="sidebar">
            <div class="row stars">
                <!-- âœ… ØµÙˆØ± Ø§Ù„Ù†Ø¬ÙˆÙ… Ù‡ØªØªØºÙŠØ± Ù…Ø¹ Ø§Ù„ØªÙ‚Ø¯Ù… -->
                <img id="star1" src="images/star1.png" alt="Ù†Ø¬Ù…Ø© 1"> <!-- Ù†Ø¬Ù…Ø© 1 Ø§ÙØªØ±Ø§Ø¶ÙŠØ© -->
                <img id="star2" src="images/star2.png" alt="Ù†Ø¬Ù…Ø© 2"> <!-- Ù†Ø¬Ù…Ø© 2 Ø§ÙØªØ±Ø§Ø¶ÙŠØ© -->
                <img id="star3" src="images/star3.png" alt="Ù†Ø¬Ù…Ø© 3"> <!-- Ù†Ø¬Ù…Ø© 3 Ø§ÙØªØ±Ø§Ø¶ÙŠØ© -->
            </div>


            <div class="row child-photo">
                <img id="childPhoto" src="images/child_photo.png" alt="ØµÙˆØ±Ø© Ø§Ù„Ø·ÙÙ„"> <!-- âœ… Ø¥Ø¶Ø§ÙØ© id -->
            </div>

            <div class="row student-name">
                <p id="studentName">Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯</p> <!-- âœ… Ø¥Ø¶Ø§ÙØ© id -->
            </div>



            <div class="row timer">
                <img src="images/timer.png" alt="Ù…Ø¤Ù‚Øª">
            </div>
            <div class="row controls">
                <!-- âœ… Ø²Ø± Ø§Ù„Ù‡ÙˆÙ… -->
                <div class="right"><img id="homeBtn" src="images/home.png" alt="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"></div>
                <!-- âœ… Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© -->
                <div class="left"><img id="retryBtn" src="images/retry.png" alt="Ø¥Ø¹Ø§Ø¯Ø©"></div>
            </div>
        </div>

        <!-- âœ… Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†Ø´Ø§Ø· -->
        <div class="content-area">
            <img src="images/actv_4.png" class="activity-label" alt="Ù†Ø´Ø§Ø· 4">
            <div class="image-box">
                <img id="wordImage" src="" alt="ØµÙˆØ±Ø© Ø§Ù„ÙƒÙ„Ù…Ø©">
            </div>
            <div class="word-drop-zone" id="wordDropZone"></div>
            <div class="letters-grid" id="lettersGrid"></div>

            <!-- Ø§Ù„Ø£ØµÙˆØ§Øª -->
            <audio id="correctSound" src="sounds/correct.mp3"></audio>
            <audio id="wrongSound" src="sounds/wrong.mp3"></audio>
            <audio id="applauseSound" src="sounds/clap.mp3"></audio>
        </div>
    </div>

    <script>

        document.addEventListener('DOMContentLoaded', function () {
            // âœ… Ø¹Ø±Ø¶ Ø§Ø³Ù… ÙˆØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø´Ø§Ø´Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const storedName = sessionStorage.getItem('userName');
            const storedImage = sessionStorage.getItem('userImage');

            if (storedName) {
                document.getElementById('studentName').textContent = storedName;
            }

            if (storedImage) {
                document.getElementById('childPhoto').src = storedImage;
            }
        });





        const words = [
            { id: 1, word: "ÙÙŠÙ„", letters: ['Ù', 'ÙŠ', 'Ù„'] },
            { id: 2, word: "Ø£Ø³Ø¯", letters: ['Ø£', 'Ø³', 'Ø¯'] },
            { id: 3, word: "Ù‚Ù„Ù…", letters: ['Ù‚', 'Ù„', 'Ù…'] },
            { id: 4, word: "Ù…Ø±ÙƒØ¨", letters: ['Ù…', 'Ø±', 'Ùƒ', 'Ø¨'] },
            { id: 5, word: "Ù†Ù…Ø±", letters: ['Ù†', 'Ù…', 'Ø±'] },
            { id: 6, word: "Ø¯ÙŠÙƒ", letters: ['Ø¯', 'ÙŠ', 'Ùƒ'] },
            { id: 7, word: "Ø·Ø§Ø¦Ø±Ø©", letters: ['Ø·', 'Ø§', 'Ø¦', 'Ø±', 'Ø©'] },
            { id: 8, word: "Ù‚Ù…Ø±", letters: ['Ù‚', 'Ù…', 'Ø±'] },
            { id: 9, word: "Ø³Ù…ÙƒØ©", letters: ['Ø³', 'Ù…', 'Ùƒ', 'Ø©'] },
            { id: 10, word: "ÙØ³ØªØ§Ù†", letters: ['Ù', 'Ø³', 'Øª', 'Ø§', 'Ù†'] },
            { id: 11, word: "Ù‚Ø·Ø©", letters: ['Ù‚', 'Ø·', 'Ø©'] },
            { id: 12, word: "ÙƒØªØ§Ø¨", letters: ['Ùƒ', 'Øª', 'Ø§', 'Ø¨'] },
            { id: 13, word: "Ø¨ÙŠØª", letters: ['Ø¨', 'ÙŠ', 'Øª'] },
            { id: 14, word: "ÙˆÙ„Ø¯", letters: ['Ùˆ', 'Ù„', 'Ø¯'] },
            { id: 15, word: "Ø¹Ù†Ø¨", letters: ['Ø¹', 'Ù†', 'Ø¨'] },
            { id: 16, word: "Ø¬Ø²Ø±", letters: ['Ø¬', 'Ø²', 'Ø±'] },
            { id: 17, word: "ØªÙØ§Ø­", letters: ['Øª', 'Ù', 'Ø§', 'Ø­'] },
            { id: 18, word: "Ù…ÙˆØ²", letters: ['Ù…', 'Ùˆ', 'Ø²'] },
            { id: 19, word: "Ø¯Ø¨", letters: ['Ø¯', 'Ø¨'] },
            { id: 20, word: "Ø±Ù…Ø§Ù†", letters: ['Ø±', 'Ù…', 'Ø§', 'Ù†'] }
        ];

        let currentWord = {};
        let placedLetters = [];
        let correctAnswers = 0; // âœ… Ø¹Ø¯Ø§Ø¯ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©

        document.addEventListener('DOMContentLoaded', startNewRound);

        // âœ… Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
        document.getElementById('retryBtn').addEventListener('click', () => {
            correctAnswers = 0; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯
            resetStars();
            startNewRound();
        });

        // âœ… Ø²Ø± Ø§Ù„Ù‡ÙˆÙ… (Ù…Ù…ÙƒÙ† ÙŠØ®Ù„ÙŠÙƒ ÙŠÙØªØ­ ØµÙØ­Ø© Ø±Ø¦ÙŠØ³ÙŠØ© Ø£Ùˆ ÙŠØ±Ø¬Ø¹Ùƒ main.html)
        document.getElementById('homeBtn').addEventListener('click', () => {
            window.location.href = "activities.html"; // ØºÙŠÙ‘Ø±Ù‡Ø§ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­
        });

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startNewRound() {
            currentWord = words[Math.floor(Math.random() * words.length)];
            document.getElementById('wordImage').src = `images/word_photo${currentWord.id}.png`;

            placedLetters = [];

            const lettersGrid = document.getElementById('lettersGrid');
            lettersGrid.innerHTML = '';

            const wordDropZone = document.getElementById('wordDropZone');
            wordDropZone.textContent = '';
            wordDropZone.style.boxShadow = '';
            wordDropZone.classList.remove('glowing-box');

            const shuffledLetters = shuffle([...currentWord.letters]);
            shuffledLetters.forEach(letter => {
                const letterDiv = document.createElement('div');
                letterDiv.textContent = letter;
                letterDiv.classList.add('letter');
                letterDiv.draggable = true;
                letterDiv.id = `draggable-${letter}-${Math.random().toString(36).substr(2, 5)}`;
                letterDiv.addEventListener('dragstart', dragStart);
                lettersGrid.appendChild(letterDiv);
            });

            setupDropZone();
        }

        function dragStart(event) {
            event.dataTransfer.setData('text/plain', event.target.textContent);
        }

        function setupDropZone() {
            const dropZone = document.getElementById('wordDropZone');
            dropZone.addEventListener('dragover', dragOver);
            dropZone.addEventListener('drop', drop);
        }

        function dragOver(event) {
            event.preventDefault();
        }

        function drop(event) {
            event.preventDefault();
            const droppedLetter = event.dataTransfer.getData('text/plain');
            const nextCorrectLetter = currentWord.letters[placedLetters.length];

            if (droppedLetter === nextCorrectLetter) {
                placedLetters.push(droppedLetter);
                document.getElementById('correctSound').play();
                document.getElementById('wordDropZone').textContent = placedLetters.join('');
                const allLetters = document.querySelectorAll('.letter');
                allLetters.forEach(el => {
                    if (el.textContent === droppedLetter) el.remove();
                });
                document.getElementById('wordDropZone').style.boxShadow = '0 0 15px 5px #ffeb3b';
                setTimeout(() => {
                    document.getElementById('wordDropZone').style.boxShadow = '';
                }, 500);

                checkCompletion();
            } else {
                document.getElementById('wrongSound').play();
            }
        }

        function checkCompletion() {
            if (placedLetters.length === currentWord.letters.length) {
                document.getElementById('applauseSound').play();
                const dropZone = document.getElementById('wordDropZone');
                dropZone.classList.add('glowing-box');
                createFlyingStars();

                // âœ… ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©
                correctAnswers++;
                updateStars();

                setTimeout(startNewRound, 4000);
            }
        }


        // âœ… Ø¯Ø§Ù„Ø© Ù…ÙˆØ­Ø¯Ø© Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù†Ø¬ÙˆÙ…
        function animateStar(starEl) {
            starEl.style.transform = 'translateX(15px) scale(1.25)'; // Ø­Ø±ÙƒØ© Ù…Ù† Ø§Ù„Ø´Ù…Ø§Ù„
            setTimeout(() => {
                starEl.style.transform = ''; // ØªØ±Ø¬Ø¹ Ù„Ù…ÙƒØ§Ù†Ù‡Ø§
            }, 250);
        }



        // âœ… ØªØºÙŠÙŠØ± Ø§Ù„Ù†Ø¬ÙˆÙ… Ø¨Ø¹Ø¯ 3 Ø«Ù… 6 Ø«Ù… 9
        function updateStars() {
            if (correctAnswers === 3) {
                const star = document.getElementById('star1');
                star.src = "images/star_red.png";
                animateStar(star); // âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø±ÙƒØ©
            } else if (correctAnswers === 6) {
                const star = document.getElementById('star2');
                star.src = "images/star_red.png";
                animateStar(star); // âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø±ÙƒØ©
            } else if (correctAnswers === 9) {
                const star = document.getElementById('star3');
                star.src = "images/star_red.png";
                animateStar(star); // âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø±ÙƒØ©
            }
        }


        // âœ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø¬ÙˆÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø©
        function resetStars() {
            document.getElementById('star1').src = "images/star1.png";
            document.getElementById('star2').src = "images/star2.png";
            document.getElementById('star3').src = "images/star3.png";
        }
        function createFlyingStars() {
            const imageBox = document.querySelector('.image-box');
            const numStars = 15;
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                const size = Math.random() * 20 + 10;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;

                const startX = imageBox.offsetLeft + imageBox.offsetWidth / 2 - size / 2;
                const startY = imageBox.offsetTop;
                star.style.left = `${startX}px`;
                star.style.top = `${startY}px`;

                const endX = startX + (Math.random() - 0.5) * 400;
                const endY = startY - 500;

                star.style.setProperty('--end-x', `${endX - startX}px`);
                star.style.setProperty('--end-y', `${endY - startY}px`);

                document.body.appendChild(star);
                setTimeout(() => { star.remove(); }, 4000);
            }
        }

        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>

</html>